<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Subs Please – Chrome Extension</title>
  <style>
    * { box-sizing: border-box; }
    html, body { height: 100%; }
    body {
      margin: 0;
      font-family: system-ui, -apple-system, Segoe UI, Roboto, Arial, "Helvetica Neue", sans-serif;
      color: #222;
      background: #fff;
      overflow: hidden;
    }

    .split {
      display: grid;
      grid-template-columns: 1fr 1fr;
      min-height: 100vh;
    }

    .left {
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 40px;
      background: linear-gradient(135deg, #f5f7ff 0%, #eef3ff 100%);
    }
    .left img {
      width: min(60%, 360px);
      height: auto;
      max-height: 60vh;
      border-radius: 12px;
      box-shadow: 0 8px 24px rgba(16, 24, 40, 0.12);
    }

    .right {
      display: flex;
      flex-direction: column;
      padding: clamp(24px, 4vw, 48px);
      gap: 16px;
    }

    header { margin-bottom: 4px; }
    h1 {
      margin: 0 0 6px 0;
      color: #111;
      font-weight: 700;
      font-size: clamp(26px, 3.2vw, 42px);
      line-height: 1.1;
    }
    .lead {
      margin: 0 0 14px 0;
      color: #555;
      font-size: clamp(14px, 1.4vw, 18px);
    }

    .btn {
      display: inline-block;
      background: #007bff;
      color: #fff;
      padding: 12px 18px;
      text-decoration: none;
      border-radius: 10px;
      font-weight: 600;
      width: fit-content;
      transition: background 0.2s ease-in-out, transform 0.06s ease-in-out;
    }
    .btn:hover { background: #0056b3; }
    .btn:active { transform: translateY(1px); }
    .btn--buy { background: linear-gradient(135deg, #16a34a, #22c55e); }
    .btn--buy:hover { background: linear-gradient(135deg, #15803d, #16a34a); }

    /* Pricing */
    .pricing {
      display: grid;
      grid-template-columns: repeat(2, minmax(0, 1fr));
      gap: 16px;
      margin-top: 8px;
    }
    .plan {
      padding: 16px;
      border-radius: 14px;
      background: #fff;
      border: 1px solid #e7e9f2;
      box-shadow: 0 8px 20px rgba(16,24,40,0.08);
      display: flex;
      flex-direction: column;
      gap: 10px;
    }
    .plan-header {
      display: flex;
      align-items: center;
      gap: 8px;
      margin: 0;
      color: #1f2937;
      font-size: clamp(16px, 1.6vw, 18px);
      font-weight: 700;
    }
    .badge {
      font-size: 12px;
      color: #7c2d12;
      background: #fff7ed;
      border: 1px solid #fed7aa;
      padding: 2px 8px;
      border-radius: 999px;
      font-weight: 600;
    }
    .copy {
      margin: 0;
      color: #475569;
      font-size: 14px;
    }
    .price {
      display: flex;
      align-items: baseline;
      gap: 10px;
    }
    .price-amount {
      font-size: clamp(26px, 3.2vw, 36px);
      font-weight: 800;
      color: #111827;
    }
    .price-note {
      color: #6b7280;
      font-size: 14px;
    }
    .strikethrough {
      text-decoration: line-through;
      color: #9ca3af;
      font-weight: 600;
    }
    .controls {
      display: flex;
      align-items: center;
      gap: 12px;
      flex-wrap: wrap;
    }
    .select {
      appearance: none;
      -webkit-appearance: none;
      -moz-appearance: none;
      background-color: #fff;
      border: 1px solid #cbd5e1;
      color: #0f172a;
      padding: 10px 12px;
      border-radius: 10px;
      min-width: 140px;
      font-weight: 600;
      box-shadow: 0 1px 0 rgba(15,23,42,0.02);
    }

    .features-title {
      margin: 12px 0 6px 0;
      font-size: clamp(18px, 2vw, 24px);
      color: #222;
    }
    .features {
      margin: 0;
      padding-left: 18px;
      color: #333;
      font-size: clamp(14px, 1.2vw, 16px);
    }
    .features li { margin: 6px 0; }

    footer {
      margin-top: auto;
      color: #666;
      font-size: 14px;
    }
    footer a { color: #007bff; text-decoration: none; }
    footer a:hover { text-decoration: underline; }

    /* Helper note */
    .minutes-note {
      margin: 0;
      color: #6b7280;
      font-size: 13px;
    }

    /* Modal styles */
    .modal-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.5);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 1000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s ease, visibility 0.3s ease;
    }
    .modal-overlay.active {
      opacity: 1;
      visibility: visible;
    }
    .modal {
      background: #fff;
      border-radius: 12px;
      padding: 24px;
      width: 90%;
      max-width: 400px;
      box-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
      transform: scale(0.9);
      transition: transform 0.3s ease;
    }
    .modal-overlay.active .modal {
      transform: scale(1);
    }
    .modal-title {
      margin: 0 0 16px 0;
      font-size: 20px;
      font-weight: 700;
      color: #111;
    }
    .modal-input {
      width: 100%;
      padding: 12px;
      border: 1px solid #cbd5e1;
      border-radius: 8px;
      font-size: 14px;
      margin-bottom: 16px;
    }
    .modal-input:focus {
      outline: none;
      border-color: #007bff;
      box-shadow: 0 0 0 3px rgba(0, 123, 255, 0.1);
    }
    .modal-buttons {
      display: flex;
      gap: 12px;
      justify-content: flex-end;
    }
    .modal-btn {
      padding: 10px 16px;
      border: none;
      border-radius: 8px;
      font-weight: 600;
      cursor: pointer;
      transition: background 0.2s ease;
    }
    .modal-btn-cancel {
      background: #f1f5f9;
      color: #475569;
    }
    .modal-btn-cancel:hover {
      background: #e2e8f0;
    }
    .modal-btn-verify {
      background: #007bff;
      color: #fff;
    }
    .modal-btn-verify:hover {
      background: #0056b3;
    }
    .modal-btn:disabled {
      opacity: 0.6;
      cursor: not-allowed;
    }
    .modal-error {
      color: #dc2626;
      font-size: 14px;
      margin-bottom: 16px;
      padding: 8px 12px;
      background: #fef2f2;
      border: 1px solid #fecaca;
      border-radius: 6px;
      display: none;
    }
    .modal-loading {
      display: none;
      text-align: center;
      color: #6b7280;
      font-size: 14px;
      margin-bottom: 16px;
    }

    /* Mobile/Small screens */
    @media (max-width: 800px) {
      body { overflow: auto; }
      .split { grid-template-columns: 1fr; min-height: auto; }
      .left { padding: 24px 16px; }
      .left img { width: 240px; max-height: none; }
      .right { padding: 24px 16px; }
      .pricing { grid-template-columns: 1fr; }
    }
  </style>
  <meta name="description" content="Subs Please – Real-time translated subtitles for any video in your browser." />
  <link rel="icon" href="logo.png" />
</head>
<body>
  <main class="split">
    <section class="left" aria-label="Logo">
      <img src="logo.png" alt="Subs Please logo" />
    </section>

    <section class="right" aria-label="Details and features">
      <header>
        <h1>Subs Please</h1>
        <p class="lead">Real-time translated subtitles for any video in your browser.</p>
      </header>

      <div>
        <a class="btn" href="https://chrome.google.com/webstore/detail/jkonhlobjgfaeiflenbfgiemkmnfpkol" target="_blank" rel="noopener">Add to Chrome</a>
      </div>

      <!-- Pricing -->
      <section class="pricing" aria-label="Pricing">
        <!-- Card 1: $1 Launch Special -->
        <article class="plan" aria-label="Launch Special">
          <h3 class="plan-header">
            Launch Special <span class="badge">Limited time</span>
          </h3>
          <p class="copy">Normally <span class="strikethrough">$10</span>. During launch, pay just <strong>$1</strong> for <strong>60 minutes of usage</strong>.</p>
          <div class="price">
            <div class="price-amount">$1</div>
            <div class="price-note">one-time</div>
          </div>
          <a id="buyOneButton" class="btn btn--buy" href="https://buy.polar.sh/polar_cl_0vRcZgTmWwv807RysTgRDH7kVCBE3fhwbdQfC08NTDR" data-polar-checkout data-polar-checkout-theme="dark">Buy for $1</a>
          <script src="https://cdn.jsdelivr.net/npm/@polar-sh/checkout@0.1/dist/embed.global.js" defer data-auto-init></script>
        </article>

        <!-- Card 2: Pay what you want -->
        <article class="plan" aria-label="Pay what you want">
          <h3 class="plan-header">
            Pay What You Want
          </h3>
          <p class="copy">Choose any amount to support the project.</p>
          <div class="controls" style="margin-top:4px;">
            <label for="anyAmount" style="color:#475569; font-size:14px;">Amount</label>
            <select id="anyAmount" class="select" aria-label="Purchase amount">
              <option value="0">$0</option>
              <option value="0.5">$0.5</option>
              <option value="5" selected>$5</option>
              <option value="10">$10</option>
              <option value="25">$25</option>
              <option value="50">$50</option>
              <option value="100">$100</option>
            </select>
          </div>
          <p id="minutesCalc" class="minutes-note">Every $1 gives you 60 minutes. Selected: $1 → 60 minutes.</p>
          <a id="buyAnyButton" class="btn btn--buy" href="https://example.com/checkout?amount=1" target="_blank" rel="noopener">Buy for $1</a>
          <a id="polarZeroFive" href="https://buy.polar.sh/polar_cl_8szKgy19zAXuCVilXzKBOd1RKQHAxCGjDwYgN0J9JlV" data-polar-checkout data-polar-checkout-theme="dark" style="display:none">Purchase</a>

          <!-- Hidden Polar checkout link for the $5 option -->
          <a id="polarFive" href="https://buy.polar.sh/polar_cl_tsPdT3wM5TbGjcd1u6Vz9bJfmqgOpvwB7hlBN0yxWle" data-polar-checkout data-polar-checkout-theme="dark" style="display:none">Purchase</a>
          <!-- Hidden Polar checkout link for the $10 option -->
          <a id="polarTen" href="https://buy.polar.sh/polar_cl_zisNg2gWEvcJyzwxWgpcZPlpu1MKjPvYZqSpm16ySLn" data-polar-checkout data-polar-checkout-theme="dark" style="display:none">Purchase</a>
          <!-- Hidden Polar checkout link for the $25 option -->
          <a id="polarTwentyFive" href="https://buy.polar.sh/polar_cl_FNsMM4rNeiT0wdnHJDcmjxWhJiDXgCTvekcWH2C7S1r" data-polar-checkout data-polar-checkout-theme="dark" style="display:none">Purchase</a>
          <!-- Hidden Polar checkout link for the $0 option -->
          <a id="polarZero" href="https://buy.polar.sh/polar_cl_Lc5vbk8TVAjhDOFdXbqyeqBj2fccNeCPMcNLa4RQd5Y" data-polar-checkout data-polar-checkout-theme="dark" style="display:none">Purchase</a>
          <a id="polarFifty" href="https://buy.polar.sh/polar_cl_YvnmNV6gIHZa8ZYfz2Mfz7ybI7JtCCEkXEubc2GLGcd"
            data-polar-checkout data-polar-checkout-theme="dark" style="display:none">Purchase</a>
          <a id="polarAHundred" href="https://buy.polar.sh/polar_cl_eD1RYyTnJcFi2sooE6kdj3aiD0I1QDj29NBuW2KOYcf"
            data-polar-checkout data-polar-checkout-theme="dark" style="display:none">Purchase</a>
        </article>
      </section>

      <h2 class="features-title">Features</h2>
      <ul class="features">
        <li>Real-time speech-to-text and translation</li>
        <li>Works with YouTube, live streams, and more</li>
        <li>Secure — no audio stored</li>
      </ul>

      <footer>
        <a href="privacy.html">Privacy Policy</a>
      </footer>
    </section>
  </main>

  <!-- Email Verification Modal -->
  <div id="emailModal" class="modal-overlay">
    <div class="modal">
      <h3 class="modal-title">Verify Your Account</h3>
      <div id="modalError" class="modal-error"></div>
      <div id="modalLoading" class="modal-loading">Verifying...</div>
      <input 
        type="email" 
        id="emailInput" 
        class="modal-input" 
        placeholder="Enter your email address"
        required
      />
      <div class="modal-buttons">
        <button id="modalCancel" class="modal-btn modal-btn-cancel">Cancel</button>
        <button id="modalVerify" class="modal-btn modal-btn-verify">Verify</button>
      </div>
    </div>
  </div>

  <script>
    (function() {
      // Replace with your actual backend API URL
      const API_BASE_URL = 'https://localhost:3000/payments';
      
      var anySelect = document.getElementById('anyAmount');
      var anyBtn = document.getElementById('buyAnyButton');
      var buyOneButton = document.getElementById('buyOneButton');
      var polarZeroFive = document.getElementById('polarZeroFive');
      var polarFive = document.getElementById('polarFive');
      var polarTen = document.getElementById('polarTen');
      var polarTwentyFive = document.getElementById('polarTwentyFive');
      var polarFifty = document.getElementById('polarFifty');
      var polarAHundred = document.getElementById('polarAHundred');
      var polarZero = document.getElementById('polarZero');
      var minutesCalc = document.getElementById('minutesCalc');
      var minutesPerDollar = 60;

      // Modal elements
      var emailModal = document.getElementById('emailModal');
      var emailInput = document.getElementById('emailInput');
      var modalCancel = document.getElementById('modalCancel');
      var modalVerify = document.getElementById('modalVerify');
      var modalError = document.getElementById('modalError');
      var modalLoading = document.getElementById('modalLoading');

      // Store the callback for after email verification
      var pendingCheckoutCallback = null;

      function showModal() {
        emailModal.classList.add('active');
        emailInput.focus();
        hideError();
      }

      function hideModal() {
        emailModal.classList.remove('active');
        emailInput.value = '';
        hideError();
        hideLoading();
        pendingCheckoutCallback = null;
      }

      function showError(message) {
        modalError.textContent = message;
        modalError.style.display = 'block';
      }

      function hideError() {
        modalError.style.display = 'none';
      }

      function showLoading() {
        modalLoading.style.display = 'block';
        modalVerify.disabled = true;
      }

      function hideLoading() {
        modalLoading.style.display = 'none';
        modalVerify.disabled = false;
      }

      async function verifyEmail(email) {
        try {
          showLoading();
          hideError();

          const response = await fetch(`${API_BASE_URL}/verify-email`, {
            method: 'POST',
            headers: {
              'Content-Type': 'application/json',
            },
            body: JSON.stringify({ email: email })
          });

          const data = await response.json();

          if (response.ok && data.verified) {
            hideModal();
            // Execute the pending checkout
            if (pendingCheckoutCallback) {
              pendingCheckoutCallback();
            }
          } else {
            showError(data.message || 'You are not registered with Subs Please. Please sign up first.');
          }
        } catch (error) {
          console.error('Email verification error:', error);
          showError('Failed to verify email. Please check your connection and try again.');
        } finally {
          hideLoading();
        }
      }

      // Modal event listeners
      modalCancel.addEventListener('click', hideModal);
      
      modalVerify.addEventListener('click', function() {
        const email = emailInput.value.trim();
        if (!email) {
          showError('Please enter your email address.');
          return;
        }
        if (!isValidEmail(email)) {
          showError('Please enter a valid email address.');
          return;
        }
        verifyEmail(email);
      });

      emailInput.addEventListener('keypress', function(e) {
        if (e.key === 'Enter') {
          modalVerify.click();
        }
      });

      // Close modal when clicking outside
      emailModal.addEventListener('click', function(e) {
        if (e.target === emailModal) {
          hideModal();
        }
      });

      function isValidEmail(email) {
        const emailRegex = /^[^\s@]+@[^\s@]+\.[^\s@]+$/;
        return emailRegex.test(email);
      }

      function requireEmailVerification(checkoutCallback) {
        pendingCheckoutCallback = checkoutCallback;
        showModal();
      }

      function updateUI() {
        var v = anySelect ? parseFloat(anySelect.value || '1') : 1;
        // Update destination for amounts not handled via Polar popup
        if (v !== 0 && v !== 0.5 && v !== 5 && v !== 10 && v !== 25 && v !== 50 && v !== 100) {
          anyBtn.href = 'https://example.com/checkout?amount=' + encodeURIComponent(v);
          anyBtn.setAttribute('target', '_blank');
          anyBtn.setAttribute('rel', 'noopener');
        } else {
          // For specific amounts, open the Polar popup via hidden anchors
          anyBtn.href = '#';
          anyBtn.removeAttribute('target');
          anyBtn.removeAttribute('rel');
        }
        if (minutesCalc) {
          var minutes = v * minutesPerDollar;
          minutesCalc.textContent = 'Every $1 gives you 60 minutes. Selected: $' + v + ' → ' + minutes + ' minutes.';
        }
        if (anyBtn) {
          anyBtn.textContent = 'Buy for $' + v;
        }
      }

      // Add email verification to the $1 launch special button
      if (buyOneButton) {
        buyOneButton.addEventListener('click', function(e) {
          e.preventDefault();
          requireEmailVerification(function() {
            // This will be called after successful email verification
            var buyOneButtonOriginal = document.querySelector('a[href*="polar_cl_0vRcZgTmWwv807RysTgRDH7kVCBE3fhwbdQfC08NTDR"]');
            if (buyOneButtonOriginal) {
              buyOneButtonOriginal.click();
            }
          });
        });
      }

      if (anySelect && anyBtn) {
        anySelect.addEventListener('change', updateUI);
        anyBtn.addEventListener('click', function(e) {
          e.preventDefault();
          var v = anySelect ? parseFloat(anySelect.value || '1') : 1;
          
          requireEmailVerification(function() {
            // This will be called after successful email verification
            if (v === 0 && polarZero) {
              polarZero.click();
            } else if (v === 0.5 && polarZeroFive) {
              polarZeroFive.click();
            } else if (v === 5 && polarFive) {
              polarFive.click();
            } else if (v === 10 && polarTen) {
              polarTen.click();
            } else if (v === 25 && polarTwentyFive) {
              polarTwentyFive.click();
            } else if (v === 50 && polarFifty) {
              polarFifty.click();
            } else if (v === 100 && polarAHundred) {
              polarAHundred.click();
            } else {
              // For custom amounts, redirect to your checkout page
              window.open('https://example.com/checkout?amount=' + encodeURIComponent(v), '_blank');
            }
          });
        });
        updateUI();
      }
    })();
  </script>
</body>
</html>
